<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:w="urn:schemas-microsoft-com:office:word"
 xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
 xmlns="http://www.w3.org/TR/REC-html40">
<head>
 
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
 
  <meta name="ProgId" content="Word.Document">
 
  <meta name="Generator" content="Microsoft Word 11">
 
  <meta name="Originator" content="Microsoft Word 11">
 
  <link rel="File-List" href="MMC-SIAM-UsersGuide_files/filelist.xml">
  <title>MMC-SIAM Users Guide</title>
  
  <style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:251089259;
	mso-list-template-ids:2126970464;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:1000814838;
	mso-list-template-ids:-4580752;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
  </style>
</head>
  <body lang="EN-US" link="blue" vlink="purple" style="">
<o:smarttagtype
 namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="country-region"> <o:smarttagtype
 namespaceuri="urn:schemas-microsoft-com:office:smarttags" name="place"> <!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>150</w:Zoom>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]--> 
 <!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--> 
  </o:smarttagtype></o:smarttagtype>
<div class="Section1">  
<p class="MsoNormal">&nbsp; </p>
  
<p align="center" style="text-align: center;"><span
 style="font-size: 13.5pt; font-family: Arial;">MMC-SIAM Users Guide</span>
</p>
  
<p align="center" style="text-align: center;"><span
 style="font-size: 13.5pt; font-family: Arial;">November 1, 2006<br>
</span></p>
  
<p align="center" style="text-align: center;"><span
 style="font-family: Arial;">Kent Headley, Bob Herlien, Tom O'Reilly, Michael
Risi, Karen Salamy</span></p>
  
<p style="margin-bottom: 12pt;"><br>
 <br>
 <br>
 <br style="">
 <!--[if !supportLineBreakNewLine]--><br style="">
 <!--[endif]--></p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#Introduction">Introduction</a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#UserAccounts">User accounts and environment</a></span> </p>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a href="#LogginIn">Logging
onto the MMC node</a></span></p>
  </blockquote>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a href="#RunningConfig">Running
the <i>config</i> script</a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#Resetting">Resetting and rebooting the MMC node</a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#SiamApplication">The SIAM <i>node</i> application</a></span> </p>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a href="#SiamPortCfg">The
siamPort.cfg file</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a href="#NodeID">The
nodeID property</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#PortProperties">Port properties</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#RarelyModifiedProps">Rarely modified properties</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#StartingNodeApp">Starting the <i>node</i> application</a></span>
  <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#ListInstruments">Listing instruments on the node</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#RemoveInstrument">Removing an instrument from the node</a></span>
  <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#InstallPuckedInstrument">Installing a "pucked" instrument onto the
node</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#InstallNonpuckedInstrument">Installing a "non-pucked" instrument
onto the node</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#ShutdownNodeApp">Shutting down the <i>node</i> application</a></span></p>
  </blockquote>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><o:p>&nbsp;</o:p></span></p>
  
<p class="MsoNormal"><span style="font-size: 16pt;"><a
 href="#ConfigInstruments">Configuring instrument services</a><o:p></o:p></span></p>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><o:p>&nbsp;</o:p></span></p>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a href="#ConfigPucks">Configuring
instrument pucks</a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#Portal">The shore <i>portal</i></a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#Clocks">System clocks</a></span> </p>
  
<p><span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#Wireless">Managing the wireless links</a></span> </p>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a
 href="#PrimaryWireless">Primary wireless link</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a
 href="#SecondaryWireless">Secondary wireless link</a></span></p>
  </blockquote>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a
 href="#PowerManagement">SIAM power management</a></span> </p>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a href="#cpuAwake">Keeping
the cpu awake</a></span> <br>
 <span style="font-size: 13.5pt; font-family: Arial;"><a href="#Leasing">Obtaining
a lease for the wireless link</a></span></p>
  
<p class="MsoNormal"><span
 style="font-size: 13.5pt; font-family: Arial;"><a
 href="#FrequentlyUsedCommands">Frequently used SIAM command summary</a></span>
</p>
  
<p><a name="Introduction"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">Introduction</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">The <i>MMC-SIAM Users
Guide</i> describes how to configure, use, and trouble-shoot a MOOS mooring
controller (MMC) running <st1:place w:st="on"><st1:country-region
 w:st="on">SIAM</st1:country-region></st1:place> software, in the lab and
while deployed at sea. This document is intended primarily for the operations
user, and so mostly describes "how to" rather than "why". Hardware and software
architecture are described elsewhere; links to these documents may be found
at the </span><a href="http://abalone.shore.mbari.org/siam/index.html">SIAM
website</a> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">A MOOS mooring consists
of one or more MMCs or "nodes"; a node on the surface buoy, and optionally,
additional nodes in the water column and on the seafloor. Each node may host
multiple science instruments through the node&#8217;s serial ports. Most of the
instrument ports on a node utilize <i>a dual port adapter</i> (DPA); each
DPA hosts two serial ports and power channels, and provides overcurrent protection
and isolation capability.</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">The surface node is 
equipped with solar panels, GPS, and RF transceivers for communications with 
shore. Optionally, one or more MMC <i>benthic instrument nodes</i> or BINs
may be connected to the surface node via an <i>EOM cable</i>; in this case
the surface node and BINs form a <i>moored network</i>. The EOM cable provides 
power and data pathways between surface and benthic nodes. Commands to instruments
and other devices, as well as instrument data flow through this network.</span>
</p>
  
<p><span style="font-size: 10pt; font-family: Arial;">A <i>portal </i>machine 
residing on shore is periodically linked to the moored observatory&#8217;s surface
node via RF link, and provides a "gateway" between the moored network and
other shore-based components, such as the Shore Side Data System (SSDS).</span>
</p>
  
<p><st1:country-region w:st="on"><i><span
 style="font-size: 10pt; font-family: Arial;">SIAM</span></i></st1:country-region><i><span
 style="font-size: 10pt; font-family: Arial;"> </span></i><span
 style="font-size: 10pt; font-family: Arial;">provides the software infrastructure
and applications for MOOS; <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> components run on the deployed
nodes as well as on shore.</span> </p>
  
<p><st1:country-region w:st="on"><st1:place w:st="on"><span
 style="font-size: 10pt; font-family: Arial;">SIAM</span></st1:place></st1:country-region><span
 style="font-size: 10pt; font-family: Arial;"> enables "self-identifying" 
instruments that are automatically recognized and processed when plugged
into the observing system at sea. Software and other information needed by
the system to operate the instrument and process its data can actually be
stored with the instrument itself in a small attached device known as an
MBARI "instrument puck". The observing system retrieves and utilizes the instrument
information when the instrument and its puck are plugged in. Some of this
information uniquely identifies the instrument serial number, its calibration
coefficients, and other characteristics of the science data; <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> automatically
associates this metadata with the instrument data stream which is eventually
processed on shore. This "plug-and-work" functionality provided by pucks
and <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> 
is very powerful, enabling automatic integration of instruments into the observing
system, even when the system has no <i>a priori</i> knowledge of the instrument,
its protocols, or data characteristics.</span> </p>
  
<p><a name="UserAccounts"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">User accounts and environment</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">Each MMC node has two
user accounts: <i>ops</i> and <i>root.</i> The <i>ops</i> login script automatically 
sets up PATH and other environment variables for <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>. Most
operations described in this manual can be executed as <i>ops</i>. Some operations
require root privileges; for these, you should first login as <i>ops</i>,
in order to set the <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> 
environment, then invoke the <i>su</i> command to become <i>root</i>. Default 
shell for both accounts is <i>bash</i>. Several environment variables are 
defined for the ops account, including:</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">SIAM_HOME &#8211; Specifies 
the top directory of the <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> software package, set to
/mnt/hda (on the compact flash). Do not modify.</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">LOG4J_THRESHOLD &#8211; specifies
the "verbosity" of debugging, error, and informational messages written to
stdout by <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> 
applications. You can set this with the <i>export</i> command to "DEBUG",
"INFO", "WARN", or "ERROR", where "DEBUG" is most verbose and "ERROR" is
least verbose.</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">SIAM_AUTOSTART &#8211; If 
true, then the <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> 
<i>node</i> application is started automatically when the MMC is rebooted
or reset. This variable is usually set automatically by the <i>config</i>
script (see below).</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">PARENT_HOST &#8211; specifies
the IP address of the shore "portal" machine. This variable is usually set
automatically by the <i>config</i> script (see below).</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a name="LogginIn"></a><b><i><span
 style="font-family: Arial;">Logging onto the MMC node</span></i></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">To log on from the MMC's 
serial console, you must connect the console cable to a serial port on your 
computer. On your computer, execute a terminal emulation program such as Hyperterm
(Windows) or minicom (Linux). The serial parameters for the console are 38400
8 N 1, with no flow control. Press return to get a login prompt or shell
prompt (if already logged in).</span> </p>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 10pt; font-family: Arial;">You can log into the node over
the network from any host which has access to the node&#8217;s ppp or ethernet
interface, by invoking the <i>ssh</i> command from that host:</span> </p>
  
  <p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">% ssh mooring</span> 
  </p>
  
  <p><span style="font-size: 10pt; font-family: Arial;">The argument to <i>ssh</i>, 
in this case "mooring", must resolve to the node&#8217;s ppp or ethernet interface.
Obviously the specified interface must "enabled" in order to connect via
  <i>ssh</i>. You can determine which interfaces are up by executing <i>/sbin/ifconfig</i>
on the node itself (e.g. if you are logged into the console). Note that the
node&#8217;s ppp interface can generally be accessed only from the <i>portal</i>
host.</span></p>
  </blockquote>
  
<p class="MsoNormal"><a name="RunningConfig"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">Running the config script</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The interactive <i>config</i> 
script modifies system configuration files in response to options specified
by the user. The <i>config</i> script should be run whenever a new version
of <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
software is installed on the node, or whenever you wish to change any of
the following system aspects:</span> <br>
 &nbsp; </p>
  
<ul type="disc">
  <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">RF link type (Globalstar, Freewave,
etc)</span></li>
  <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">Ethernet configuration (enabled,
disabled)</span></li>
  <li class="MsoNormal" style=""><st1:country-region w:st="on"><st1:place
 w:st="on"><span style="font-size: 10pt; font-family: Arial;">SIAM</span></st1:place></st1:country-region><span
 style="font-size: 10pt; font-family: Arial;"> node auto-start option</span></li>
  <li class="MsoNormal" style=""><st1:country-region w:st="on"><st1:place
 w:st="on"><span style="font-size: 10pt; font-family: Arial;">SIAM</span></st1:place></st1:country-region><span
 style="font-size: 10pt; font-family: Arial;"> informational message level 
     (DEBUG, INFO)</span></li>
  <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">Name of the shore <i>portal
    </i>host</span></li>
 
</ul>
  
<p><br>
 <span style="font-size: 10pt; font-family: Arial;">To run <i>config</i>,
first log into the MMC as &#8216;ops&#8217;, then run the <i>su</i> command to get root
permissions. Then simply type <i>config</i>; the script will prompt for the
options listed above. After all options have been entered by the user, the 
script prints out a review of user inputs, and gives the option to continue
or abort the script. If the user elects to continue, <i>config</i> then automatically
modifies the relevant Linux and <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> scripts. Note that the MMC 
must be rebooted before the changes take effect.</span> </p>
  
<p><a name="Resetting"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">Resetting and rebooting the
MMC node</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">The MMC can be restarted 
either via the <i>reboot</i> command, or by a hardware reset.</span> <br>
 <b><span style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> You should terminate
the <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
<i>node</i> application if possible before rebooting or resetting the MMC.</span>
<br>
 <b><span style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> It is very important
that you issue the sync command immediately prior to rebooting or resetting
the MMC</span> </p>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><b><span style="font-family: Arial;">Rebooting the
node</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">As user root, type the 
following commands:</span></p>
  </blockquote>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">sync; reboot</span>
  </p>
  
  <p><span style="font-size: 10pt; font-family: Arial;">The system will synchronize 
the file system and then reboot; after the reboot process completes, the command
prompt will appear on the console.</span></p>
  </blockquote>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><b><span style="font-family: Arial;">Resetting the
node</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">As user &#8216;root&#8217;, type
the following commands:</span> </p>
  
  <p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">sync; halt</span></p>
  </blockquote>
  
<blockquote style="margin-top: 5pt; margin-bottom: 5pt;">  
  <p class="MsoNormal"><span
 style="font-size: 10pt; font-family: Arial;">When the &#8216;halt&#8217; process completes,
the message "Power down" appears on the console; only then is it safe to
reset the node. You can then reset either by pressing the reset button on
the Sidearm board, or by calling the reset pager phone number.</span> </p>
  
  <p><span style="font-size: 10pt; font-family: Arial;">To access the reset
button, the MMC can must be open and the Sidearm board must be accessible.</span>
  </p>
  
  <p><span style="font-size: 10pt; font-family: Arial;">After dialing the
reset pager number, enter any digits (e.g. "111") when prompted by the beep 
tone. Hang up when you hear the "thank you" response. The onboard reset pager
should be notified within a few minutes. <b><span style="color: red;">NOTE:</span></b><span
 style="color: red;"> occasional pager delays of many minutes, perhaps even
an hour or more, have been observed.</span></span></p>
  </blockquote>
  
<p class="MsoNormal"><a name="SiamApplication"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">The <st1:country-region
 w:st="on">SIAM</st1:country-region> node application</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">The <st1:place
 w:st="on"><st1:country-region w:st="on">SIAM</st1:country-region></st1:place>
<a href="node.html"><i>node</i> application</a> is a Java program that is
executed on the MMC node. <i>node</i> loads and executes instrument service
code from pucks or jar files, acquires and logs instrument data using user-specified
schedules, manages power to instruments, and manages processor state between
"running" and "sleeping" to conserve power. The <i>node</i> application provides 
interfaces that allow other programs to interact with the mooring via a TCP/IP 
network, using a mechanism known as <i>Java RMI</i> (Remote Method Invocation). 
The <i>node</i> application is an RMI server; client applications such as
<i>portal, listPorts, scanPort,</i> etc can invoke operations on the node
via the network, whether the physical link be ethernet in the laboratory
or wireless RF while the system is at sea.</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a name="SiamPortCfg"></a><b><i><span
 style="font-family: Arial;">The siamPort.cfg file</span></i></b> <br>
 <i><span style="font-size: 10pt; font-family: Arial;">node</span></i><span
 style="font-size: 10pt; font-family: Arial;"> application options can be 
specified by setting "Java properties" before executing the application.
The properties are stored in the <i>$SIAM_HOME/properties/siamPort.cfg</i> 
file. Properties are specified as <i>name=value</i> pairs. A backslash &#8216;\&#8217;
as the last character on a line means the property is continued on the next
line, e.g.:</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">platformSerialPorts 
= /dev/ttySX0:\</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">/dev/ttySX1:\</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">/dev/ttySX2</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">A "#" character at the beginning
of a line denotes a comment.</span> </p>
  
<p style="margin-left: 0.5in;"><b><span
 style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> in-line comments
on the same line as the name=value pair are <u>not</u> allowed. E.g. the
following is an error:</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: red;">&nbsp;&nbsp;&nbsp;
nodeID = 4912 # Comment placed here is not allowed!</span> </p>
  
<p style="margin-left: 0.5in;"><b><span
 style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> the properties
are read from siamPort.cfg only when <i>node</i> is started. Any user edits
to siamPort.cfg will not take effect until the <i>node</i> application is
restarted.</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1in;"><a name="NodeID"></a><b><span
 style="font-size: 10pt; font-family: Arial;">The <i>nodeID</i> property</span></b> 
<br>
 <span style="font-size: 10pt; font-family: Arial;">The node ID is a unique 
integer associated with this node. Node IDs are assigned by the Shore Side
Data System project; enter the assigned value for this property. <b><span
 style="color: red;">NOTE:</span></b><span style="color: red;"> you must
ensure that this property is set to the assigned value.</span></span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">nodeID = 4912</span> </p>
  
<p style="margin-left: 1in;"><a name="PortProperties"></a><b><span
 style="font-size: 10pt; font-family: Arial;">Port properties</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The operations user might
need to modify these properties if a port is to be "preconfigured" with a 
particular instrument service, instead of using a puck.</span> <br>
 <span style="font-size: 10pt; font-family: Arial;">Instrument ports and
the source of the instrument service on each port are specified with the
<i>serialPort</i>, <i>powerPort</i>, and <i>serviceJar</i> properties. Ports
are numbered consecutively, starting at 0. For each port, you must specify
three properties as follows:</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort<i>n</i> =
<i>serialName</i></span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort<i>n</i>
= <i>powerName</i></span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar<i>n</i>
= <i>jarName</i></span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">where <i>n</i> is the port
number.</span> </p>
  
<p style="margin-left: 1in;"><i><span
 style="font-size: 10pt; font-family: Arial;">serialName</span></i><span
 style="font-size: 10pt; font-family: Arial;"> is the name of the serial
device, including the leading Linux /dev directory, e.g. "/dev/ttySX0".</span> 
<br>
 <i><span style="font-size: 10pt; font-family: Arial;">powerName </span></i><span
 style="font-size: 10pt; font-family: Arial;">must be either "DPA" or left
blank; "DPA" indicates that the port is associated with a dual port adapter;
blank means that the serial port is <u>not</u> associated with a DPA.</span>
</p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">Finally,<i> jarName</i> is
"PUCK", the name of a Java jar file in $SIAM_HOME/ports, or "EMPTY". A value
of "PUCK" indicates that the serial port should be "scanned" for a puck.
If <i>jarName</i> is the name of a jar file in $SIAM_HOME/ports, it instructs
<st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
to load the instrument service from that jar file; this allows you to bypass
the puck mechanism and "preconfigure" the service. "EMPTY" means there is 
definitely no instrument plugged in, and <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> does not attempt to scan
for a puck. Note that "EMPTY" is never strictly necessary; if a port is empty
and SIAM tries to scan for a puck, a message indicating "no puck present"
will be written to the stdout. Likewise, if a jar file in the ports directory
cannot be loaded for some reason, an error message is generated and <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> continues
with the next port. "EMPTY" simply skips the port, thus saving several seconds.</span>
</p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">Following are examples of these
properties:</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort0 = /dev/ttySX0</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort0 =
DPA</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar0 =
PUCK</span> </p>
  
<p style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort1 = /dev/ttySX1</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort1 =
DPA</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar1 =
EMPTY</span> </p>
  
<p style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort2 = /dev/ttySX2</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort2 =
DPA</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar2 =
PUCK</span> </p>
  
<p style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort3 = /dev/ttySX3</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort3 =
DPA</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar3 = 
PowerCan-1322.jar</span></p>
  
<p style="margin-left: 1in;"><br>
 <b><span style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> These properties
must be specified with consecutively increasing port numbers; if a number
in the sequence is missing, <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> will stop searching for
ports.</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">By convention, /dev/ttySX15
is reserved for the MSP430 environmental processor, which has no associated
DPA:</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># NOTE: Environmental
sensors are always on /dev/ttySX15 (no DPA on this port)</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort12
= /dev/ttySX15</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort12 =</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar12
= MSP430-1300.jar</span> </p>
  
<p style="margin-left: 1in;"><br>
 <a name="RarelyModifiedProps"></a><b><span
 style="font-size: 10pt; font-family: Arial;">Rarely modified properties</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The following properties
are rarely if ever modified by the operations user.</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">The </span><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">platformSerialPorts</span><span
 style="font-size: 10pt; font-family: Arial;"> property is a colon-separated
list of all of the available serial ports on the platform. <st1:country-region
 w:st="on">SIAM</st1:country-region> will search the system for serial ports
if this entry is left blank or not present; however, <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> may
not find them all. If this entry is set <st1:country-region w:st="on"><st1:place
 w:st="on">SIAM</st1:place></st1:country-region> will only know about these
serial ports and will not search for others. For sideARM systems the entry
should be set as follows:</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">platformSerialPorts 
= /dev/ttySX0:/dev/ttySX1:/dev/ttySX2:/dev/ttySX3:/dev/ttySX4:/dev/ttySX5:/dev/ttySX6:/dev/ttySX7:/dev/ttySX8:/dev/ttySX9:/dev/ttySX10:/dev/ttySX11:/dev/ttySX15:/dev/ttySA2</span> 
</p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">The following properties specify
the directory paths for log files, instrument service jar files, and the
node&#8217;s codebase; these properties should not be modified:</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># Instrument service
jar files go here (path relative to $SIAM_HOME)</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">jarLocation =
ports</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># Instrument logs go
here (path relative to $SIAM_HOME)</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">logLocation =
logs</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># Codebase location
(absolute path)</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">codebaseLocation
= /mnt/hda/codebase</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">The following properties control
the behavior of sleep manager, which, if enabled, puts the Sidearm processor
into low-power "sleep" mode when no tasks need to be executed, and causes
the processor to "wake up" as tasks become imminent.</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># enabled: true to
enable, false means you'll never go to sleep</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.enabled
= true</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># sleepString: command
to invoke to put us to sleep</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.sleepString 
= /root/suspend.sh</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># pollSeconds: How
often we poll to see if we can go to sleep</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.pollSeconds 
= 2</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># sleepDelay: How long
to delay before going to sleep, to allow logs</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># to get out
to the flash file system. This one is in milliseconds.</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.sleepDelay 
= 0</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># wakeupSeconds: How
many seconds we wake up early, to allow things to</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># stabilize before 
sampling.</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.wakeupSeconds 
= 3</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># minSleepSeconds:
Minimum time we'll go to sleep. If less than this,</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># we'll just
stay awake.</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">SleepManager.minSleepSeconds 
= 5</span></p>
  
<p class="MsoNormal" style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">The following NodeService and
CommsManager properties manage the communications link between the MMC node
and the shore portal. Following is a description of the comms session and
what the properties mean. All values are in milliseconds, and have reasonable
defaults.</span> </p>
  
<p style="margin-left: 1in;"><i><span
 style="font-size: 10pt; font-family: Arial;">CommsSchedulerTask</span></i><span
 style="font-size: 10pt; font-family: Arial;"> is responsible for ensuring
that a comms link is up for certain number of minutes per hour. Every &lt;<i>NodeService.leaseRenewalInterval</i>&gt; 
milliseconds, <i>CommsSchedulerTask</i> establishes a lease (which ensures
that comms are alive) for &lt;<i>NodeService.leaseInterval</i>&gt; milliseconds.
<i>CommsManager.enabled</i> enables <i>CommsLeaseListener</i>. This should
normally remain true. If false, not only will <i>CommsLeaseListener </i>never
set up the comms link, but it will also never notify the portal side that
the link is up.</span> </p>
  
<p style="margin-left: 1in;"><i><span
 style="font-size: 10pt; font-family: Arial;">CommsManager.onString</span></i><span
 style="font-size: 10pt; font-family: Arial;"> and <i>CommsManager.offString</i> 
are set to the names of Linux executables that set up and tear down the comms 
link, respectively. If these properties are not defined, <i>CommsLeaseListener
</i>does not try to set up the link, but will directly send the portal notifications. 
These properties very useful for testing, e.g. on ethernet. Just comment
out the properties, and it will work on ethernet or any other permanently
connected device.</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">Conversely, <i>CommsManager.protocolWaitTime</i>
is the wait time before the link is torn down. That is, when the last lease
either expires or is terminated <i>CommsLeaseListener</i> will send a "disconnecting"
message, then wait for <i>protocolWaitTime</i>, and then tear down the link
by invoking the program specified by <i>CommsManager.offString</i></span> 
</p>
  
<p style="margin-left: 1in;"><i><span
 style="font-size: 10pt; font-family: Arial;">CommsManager.processWaitTime</span></i><span
 style="font-size: 10pt; font-family: Arial;"> is the time, in milliseconds,
that we'll wait for the <i>onString</i> or <i>offString</i> scripts to complete, 
before we timeout and kill the respective processes. If this property is missing
or non-positive, we wait forever.</span> </p>
  
<p style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">Following are example
settings for these properties:</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">CommsManager.enabled
= true</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">NodeService.leaseInterval 
= 30000</span> </p>
  
<p style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># For deployment</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">NodeService.leaseRenewalInterval 
= 600000</span> </p>
  
<p style="margin-left: 1.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"># Added by config script:
user specified link 'freewave'</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">CommsManager.onString 
= pon longhaul</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">CommsManager.offString 
= commsOff longhaul</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">CommsManager.protocolWaitTime 
= 5000</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">CommsManager.processWaitTime 
= 60000</span> <br>
 &nbsp;</p>
  
<p class="MsoNormal" style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: Arial;">The <i>advertiseService</i>
property is rarely if ever directly modified by the operations user.</span>
</p>
  
<p class="MsoNormal" style="margin-left: 1in;">&nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a
 name="StartingNodeApp"></a><b><i><span style="font-family: Arial;">Starting
the node application</span></i></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">The system is normally 
configured to "auto-start" the node application on MMC reboot or reset; see
</span><i><a href="#RunningConfig">config</a></i><span
 style="font-size: 10pt; font-family: Arial;">. For test purposes it is also 
possible to start node from the command line. To start from the command line, 
you must first change directory to the $SIAM_HOME directory. To get to the 
SIAM_HOME directory, you can execute the <i>gosiam</i> command, with no arguments.
Then execute the <i>node</i> command, specifying the name of the shore portal
host as an argument, e.g.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">% node <i>shore</i></span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">The argument "shore" refers
to the name of an IP interface on the portal&#8217;s host machine, and must correspond
to an entry in the MMC's <i>/etc/hosts</i> file. The </span><a
 href="#Portal">portal</a>&nbsp;<span
 style="font-size: 10pt; font-family: Arial;"> is described in more detail
below.</span> </p>
  
<p style="margin-left: 0.5in;"><b><span
 style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> Only one instance
of <i>node</i> may be executed on the node at any given time. </span><span
 style="font-size: 10pt; font-family: Arial;">Before starting <i>node</i>
manually, insure that it is not already running, using the ps command to
search for any instances of the j9 Java virtual machine:</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">ps &#8211;eaf | grep j9</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">If the above command results
in multiple output lines of the form</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">ops 2039 2037 3 21:12
/mnt/hda/siam/ 00:00:08 j9 - mca:32 -mco:64 -mx</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">then the application is likely
already running, and you must use invoke<i> </i></span><i><a
 href="#ShutdownNodeApp">exitNode</a></i><span
 style="font-size: 10pt; font-family: Arial;">before restarting.</span> </p>
  
<p style="margin-left: 0.5in;"><a name="ListInstruments"></a><b><i><span
 style="font-family: Arial;">Listing instruments on the node</span></i></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The <i><a
 href="listPorts.html">listPorts</a></i> command displays a list of currently
running <st1:place w:st="on"><st1:country-region w:st="on">SIAM</st1:country-region></st1:place>
instrument services associated with each instrument port on the node.</span>
</p>
  
<p style="margin-left: 0.5in;"><a name="RemoveInstrument"></a><b><i><span
 style="font-family: Arial;">Removing an instrument from the node</span></i></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">An instrument can be
removed from the MMC while the <i>node</i> application is running. First,
execute the <i><a href="shutdownPort.html">shutdownPor</a>t </i>utility,<i>
</i>which causes the instrument service on the specified port to shut down
"gracefully", and removes power from the port&#8217;s DPA channel. When <i>shutdownPort
</i>has completed, it is safe to physically unplug the instrument from the
port.<i> </i><b><span style="color: red;">NOTE: </span></b><i><span
 style="color: red;">shutdownPort</span></i><span style="color: red;"> may
in some cases take several minutes to complete. If an instrument is sampling,
at the time shutdownPort is invoked, shutdownPort will block until the sampling
is complete.</span></span> </p>
  
<p style="margin-left: 0.5in;"><a name="InstallPuckedInstrument"></a><b><i><span
 style="font-size: 10pt; font-family: Arial;">I</span></i></b><b><i><span
 style="font-family: Arial;">nstalling a "pucked" instrument onto the node</span></i></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">A pucked instrument can
be plugged into the MMC and its service started while the <i>node</i> application 
is running, if the port has been configured for a puck in the </span><i><a
 href="#SiamPortCfg">siamPort.cfg</a></i>&nbsp;<span
 style="font-size: 10pt; font-family: Arial;"> properties file. First, physically
plug the pucked instrument into the port. Then execute the <i><a
 href="scanPort.html">scanPort</a></i> utility, which causes <st1:place
 w:st="on"><st1:country-region w:st="on">SIAM</st1:country-region></st1:place> 
to search for and communicate with the puck on the specified port, retrieve
the instrument service jar file from the puck, and execute the service code.
<b><span style="color: red;">NOTE:</span></b><span style="color: red;"> In
some cases, <i>scanPort</i> may take several minutes to complete, depending
on the time required to initialize the particular instrument</span>.</span>
</p>
  
<p style="margin-left: 0.5in;"><a name="InstallNonpuckedInstrument"></a><b><i><span
 style="font-family: Arial;">Installing a "non-pucked" instrument onto the
node</span></i></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">A non-pucked instrument
can be plugged into an MMC port and its service started while the <i>node</i> 
application is running, if the appropriate jar file has been specified beforehand
in the </span><i><a href="#SiamPortCfg">siamPort.cfg</a></i><span
 style="font-size: 10pt; font-family: Arial;"> properties file. Suppose that
you want to pre-configure /ttySX3 for a Seabird CTD. Suppose the jar file
for this service is called "Seabird-1289.jar"; this service <u>must</u> be 
placed in the <i>$SIAM_HOME/ports</i> directory. The entry in <i>siamPort.cfg</i> 
then must be modified as follows:</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serialPort3 = /dev/ttySX3</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">powerPort3 =
DPA</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">serviceJar3 = 
Seabird-1289.jar</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">The <i>node</i> application
must be restarted in order for any <i>siamPort.cfg</i> changes to take effect.</span>
</p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><o:p>&nbsp;</o:p></p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a
 name="ShutdownNodeApp"></a><b><i><span style="font-family: Arial;">Shutting
down the node application</span></i></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">The node application
can be "gracefully" terminated with the <i><a href="exitNode.html">exitNode</a></i> 
command; <i>exitNode</i> causes the <i>node</i> application to first shutdown 
each individual instrument service and disconnect power to the ports before 
exiting. In some cases, <i>exitNode</i> may block for long periods, such
as when an instrument service is in the middle of a long sample acquisition.
In this case, the user may wish to use the <i><a href="killj9.html">killj9</a></i> 
utility to shut down the node application immediately.&nbsp;</span> </p>
  
<p style="margin-left: 0.5in;"><b><span
 style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><i><span
 style="font-size: 10pt; font-family: Arial; color: red;"> killj9</span></i><span
 style="font-size: 10pt; font-family: Arial; color: red;"> does <u>not</u>
"gracefully" terminate instrument services, and may leave instruments in
a powered state. Instead, use <i>exitNode</i> where possible</span><span
 style="font-size: 10pt; font-family: Arial;">.</span> <br style="">
 <!--[if !supportLineBreakNewLine]--><br style="">
 <!--[endif]--></p>
  
<p class="MsoNormal"><a name="ConfigPucks"></a><a
 name="ConfigInstruments"></a><b><span
 style="font-size: 14pt; font-family: Arial;">Configuring instrument services<o:p></o:p></span></b></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">The
following entries describe how to configure instrument service behavior;<o:p></o:p></span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;"><a
 href="instrumentProperties.html">Instrument service properties</a><o:p></o:p></span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;"><a
 href="scheduler.html">Instrument scheduling</a><o:p></o:p></span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;"><a
 href="summariesAndFiltering.html">Instrument data summarization and subsampling</a>
<span style="">&nbsp;</span><o:p></o:p></span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;"><o:p>&nbsp;</o:p></span></p>
  
<p class="MsoNormal"><b><span
 style="font-size: 13.5pt; font-family: Arial;">Configuring instrument pucks</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">To configure a puck for
an instrument it is necessary to have an appropriate jar file, a means of
powering up the puck and a system with an available serial port and <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> software 
installed. The jar file contains the instrument service code, instrument properties
and XML. Jar files for instruments can be acquired from the [ ??? ] repository.
It is possible to configure pucks with a desktop/laptop computer or directly
from the MMC. The steps involved with configuring a puck are</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">apply power to the puck</span>
<br>
 <span style="font-size: 10pt; font-family: Arial;">issue the <i><a
 href="writePuck.html">writePuck</a></i> command with the appropriate jar
file and serial port specified</span> <br>
 <span style="font-size: 10pt; font-family: Arial;">remove power from the
puck after the write is complete</span> </p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">To
retrieve the contents of a puck the <i><a href="readPuck.html">readPuck</a></i>
command can be used to copy the contents of a puck into a file on the attached
system. As with <i>writePuck</i> you need a means of powering the puck and
a system with the necessary software. To retrieve the contents of a puck
you must</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">apply power to the puck</span>
<br>
 <span style="font-size: 10pt; font-family: Arial;">issue the <i>readPuck</i> 
command with the appropriate serial port specified</span> <br>
 <span style="font-size: 10pt; font-family: Arial;">remove power from the
puck when the read is complete</span> </p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">If
you need to determine the contents of a puck but don&#8217;t actually need the
jar file from it you can use the <i><a href="catPuck.html">catPuck</a></i>
command. The steps required to use <i>catPuck</i> are identical <i>to readPuck</i>.
The <i>catPuck</i> command will, however, only return a brief description
of the puck&#8217;s contents. See example below:</span> </p>
  
<p class="MsoNormal"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">org ID : 1</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">type ID : 1</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">unique ID : bf0a2eb9-a5ec-11d8-8a78-000c6a000402</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">payload size
: 33204</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">checksum : 0x91ecc72d</span> 
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">service name
: Mooring power can</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">ISI ID : 1322</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">current limit
: -1</span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">The 
&#8216;service name&#8217; identifies the instrument type and the &#8216;ISI ID&#8217; identifies
the instrument uniquely and can be used in conjunction with the shore side
data system to access the archived data from this instrument.</span> </p>
  
<p><b><span style="font-size: 10pt; font-family: Arial; color: red;">NOTE:</span></b><span
 style="font-size: 10pt; font-family: Arial; color: red;"> power must be
removed from pucks for no less then 5 seconds before reapplying power. Failure
to remove power from a puck for a period of less than 5 seconds may result
in an unpredictable state on power up.</span> </p>
  
<p><a name="Portal"></a><b><span
 style="font-size: 13.5pt; font-family: Arial; color: black;">The shore <i>portal</i></span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The <st1:place
 w:st="on"><st1:country-region w:st="on">SIAM</st1:country-region></st1:place>
<i><a href="portal.html">portal</a></i> server application runs on a shore-based
machine, and periodically retrieves data from one or more MMC nodes, using
the network provided by the RF link; <i>portal</i> logs the retrieved data
locally on its host and also optionally "publishes" data to the<i> Shore
Side Data System</i> (SSDS). See the <i>portal</i> manual page for details.</span>
<br>
 &nbsp; </p>
  
<p><a name="Clocks"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">System clocks</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The MOOS mooring controller, 
running Linux, has 3 concepts of time:</span> </p>
  
<ol start="1" type="1">
  
  <ul type="circle">
   <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">The <i>system time</i> - time 
      maintained in the Linux software, driven by a periodic interrupt.&nbsp;
It's       volatile; it goes away when the system boots.&nbsp; The resolution
is       dependent on the frequency of the clock interrupt, but typically
it's on       the order of 10 ms.</span></li>
   <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">The SA1100 RTC &#8211; the      
real-time clock built into the StrongArm processor chip.&nbsp; It       persists
through reboot cycles, but will be cleared if the system is       powered
down.&nbsp; It has a resolution of 1 second.</span></li>
   <li class="MsoNormal" style=""><span
 style="font-size: 10pt; font-family: Arial;">The Ricoh RTC, which is a 
     separate chip added to version 4 and later of the Sidearm CPU      
board.&nbsp; It persists forever, as long as its battery is alive.&nbsp; 
     It has a resolution of 1 second.</span></li>
  
  </ul>
 
</ol>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">The
MOOS mooring controller also has the ability to synchronize system time with
a shore system via a TCP/IP connection using the network time protocol (NTP).</span>
</p>
  
<p><span style="font-size: 10pt; font-family: Arial;">Whenever the controller 
returns from sleep, the Ricoh RTC is used to set system time. This is used
to eliminate systemic time errors that would otherwise occur when returning
from sleep. At the end of every communication session with shore the Linux 
&#8216;ntpdate&#8217; command is used to set system time. If the &#8216;ntpdate&#8217; command is
successful the Ricoh RTC is updated with the system time.</span> </p>
  
<p><span style="font-size: 10pt; font-family: Arial;">System time can be
set from the Linux command line using the &#8216;date&#8217; command. Help for the date 
command is available at the Linux command line using the &#8211;help flag as follows,</span>
</p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">mooring:~$ date --help</span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">Similarly, 
the SA-1100 clock can be set from the Linux command line using the &#8216;hwclock&#8217;
command. Help for the &#8216;hwclock&#8217; command is available at the Linux command
line using the &#8211;help flag as follows:</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">mooring:~$ hwclock
&#8211; help</span></p>
  
<p class="MsoNormal"><span style="font-size: 10pt; font-family: Arial;">To
set the Ricoh battery backed up clock, use the &#8216;<a href="ricohRTC.html">ricohRTC</a>&#8217; 
program located in the /root directory. The ricohRTC program has an interactive 
user mode, can set the system time from the Ricoh clock or set the Ricoh
clock from the system time. You can also set other clock properties using
ricohRTC. For a full description of the program&#8217;s capabilities, see the <a
 href="ricohRTC.html">ricohRTC</a> documentation or use the &#8211;h flag with ricohRTC
as follows:</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">mooring:~$ /root/ricohRTC
&#8211;h<o:p></o:p></span></p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><o:p>&nbsp;</o:p></p>
  
<p class="MsoNormal"><a name="Wireless"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">Managing the wireless links</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">There are potentially
two wireless links managed by SIAM-MMC &#8211; the primary link and the secondary 
link. The primary link is the communications channel that is managed by the
<st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> 
application itself, and is used to download data to the portal onshore. The 
secondary link, if installed, is used only for a Linux console connection.
Both links, though, are power-managed; that is, they are on for only short
periods of time, and off most of the time to save power.</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a
 name="PrimaryWireless"></a><b><i><span
 style="font-size: 10pt; font-family: Arial;">Primary wireless link</span></i></b> 
<br>
 <span style="font-size: 10pt; font-family: Arial;">The primary link is always 
installed, and is used for data downloads to the portal. This link uses PPP
as the link-level protocol, and TCP/IP and RMI run on top of that.</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">At least two versions of this
link have been implemented &#8211; a version that uses Globalstar satellite radio
and a version that uses the Freewave radio modem. The difference is simply
in the script that is passed to PPP to initialize the link.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">When <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region> needs
to use the link, it calls the script indicated by the system property "CommsManager.onString".
This is typically either "pon longhaul" or "pon globalstar". When it&#8217;s done
with the link, it calls the "CommsManager.offString" script, typically commsOff,
which is a script that, among other things, calls "poff longhaul" or "poff
globalstar".</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">The <i>pon</i> and <i>poff
</i>scripts (located in /usr/sbin) simply call and destroy <i>pppd</i>. Invoking
"pon longhaul" is equivalent to a command of "pppd call longhaul". The object
of the call, in this case, "longhaul", is expected to be a file containing
pppd options, located in /etc/ppp/peers. These files (/etc/ppp/peers/longhaul
and /etc/ppp/peers/globalstar) contain command-line options that are passed
to pppd. If you do a "man pppd" on any standard Linux system, you&#8217;ll find
a rich set of options that <i>pppd</i> understands. For example, the /etc/ppp/peers/longhaul
file contains the following (as of this writing):</span> <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-left: 1in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">linkname longhaul</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">mooring:</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">ipparam mbari</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">noauth</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">noipdefault</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">defaultroute</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">deflate 14</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">updetach</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">ttySX12</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">57600</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">local</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">crtscts</span>
<br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lock</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lcp-echo-interval
5</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lcp-echo-failure
3</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">connect "/mnt/hda/siam/utils/rfpower.ops
1 on"</span> <br>
 <span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">disconnect "/mnt/hda/siam/utils/rfpower.ops
1 off"</span> </p>
  
<p style="margin-left: 0.5in;"><br>
 <span style="font-size: 10pt; font-family: Arial;">Among other things, it
tells <i>pppd</i> to use the IP address associated with "mooring:", to use
serial port /dev/ttySX12 at 57600 baud, don&#8217;t use the carrier detect line
(local), but do use RTS/CTS (crtscts). It also tells it to turn on radio
power when trying to connect (connect rfpower.ops 1 on) and turn it off when 
disconnecting.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">/etc/ppp/peers/globalstar has
a similar but slightly different set of options. You can configure the way 
that pppd uses the link by editing the appropriate file in /etc/ppp/peers.</span> 
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">The commsOff script is located
in /mnt/hda/siam/utils/commsOff, and primarily calls "poff &lt;linkname&gt;".
It also calls ntpdate for time management, and makes sure radio power is
off (in case pppd fails).</span> </p>
  
<p style="margin-left: 0.5in;"><a name="SecondaryWireless"></a><b><i><span
 style="font-size: 10pt; font-family: Arial;">Secondary Link</span></i></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The secondary link, when 
present, is used simply as a Linux login console. It&#8217;s enabled by inserting
the following line into file /etc/inittab:</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">T13:23:respawn:/etc/auxTelem.sh 
-b 38400 -t 30 -s 300 &amp;&gt;/dev/null</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">This causes the system to run
the script <a href="auxTelem.html">/etc/auxTelem.sh</a>, and to rerun it
continuously when it exits. This script, in turn, calls the Linux command
"getty", which prints the login prompt to the port.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">The &#8211;b option tells it the
baud rate. The &#8211;t option is the timeout for "getty" &#8211; after that number of
seconds, getty times out and the radio is turned off. The &#8211;s option tells
it how long to sleep before running again.</span></p>
  
<p class="MsoNormal"><a name="PowerManagement"></a><st1:country-region
 w:st="on"><b><span style="font-size: 13.5pt; font-family: Arial;">SIAM</span></b></st1:country-region><b><span
 style="font-size: 13.5pt; font-family: Arial;"> power management</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The <st1:country-region
 w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region><i>
node </i>application does several things to minimize power usage. Among other
things, it puts the CPU into sleep mode when not busy (sleep management)
and turns off power to the radio(s) when they&#8217;re not in use (radio power
management).</span> </p>
  
<p class="MsoNormal" style="margin-left: 0.5in;"><a
 name="SleepManagementProperties"></a><b><i><span
 style="font-size: 10pt; font-family: Arial;">SleepManager properties</span></i></b> 
<br>
 <span style="font-size: 10pt; font-family: Arial;">Sleep Manager is configured
by a number of system properties in the siamPort.cfg file. This has already
been documented in the section on siamPort.cfg, but most of those properties
should never need to be changed. There are really only two properties you
need be concerned with.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">SleepManager.enabled can be
set to false to disable sleep management. If you do this, the CPU will never
go into sleep mode. For normal (power saving) operation, set this property
to true.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">SleepManager.sleepString is
normally set to "/root/suspend.sh". This is a shell script in the /root directory
(caution &#8211; it must be owned by root and have the setuid bit on &#8211; &#8216;chmod 4755
suspend.sh). The line in this file that actually puts the CPU to sleep is
the call to <i><a href="suspend.html">suspend</a></i> (which also must be
owned by root with setuid bit on). The rest of the script does things like
sync the file system, manage the RTC, etc. The call to &#8216;setPWER&#8217; can be changed
to allow other conditions to wake up the CPU from sleep &#8211; see the SA1100
Microprocessor manual section on the PWER register. Most of the bits in PWER
allow bits in the GPIO register to wake us up; see the Sidearm4 hardware
documentation for the use of GPIO.</span> </p>
  
<p style="margin-left: 0.5in;"><a name="cpuAwake"></a><b><span
 style="font-size: 10pt; font-family: Arial;">Keeping the cpu awake</span></b>
<br>
 <span style="font-size: 10pt; font-family: Arial;">The <i><a
 href="cpuAwake.html">cpuAwake</a></i> utility can be used to establish a
&#8220;cpu lease&#8221;; the cpu lease keeps the CPU awake for a period of time. If you&#8217;re
logged onto the <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
node in a Linux shell, you can simply type the command</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">cpuAwake <i>seconds</i></span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">to stay awake the indicated
number of seconds. When done, type</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">cpuAwake 0</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">to indicate you no longer need
the system awake. See the HTML documentation on <i><a
 href="cpuAwake.html">cpuAwake</a></i> for the full command syntax. Note
that cpuAwake does not guarantee availablility of the wireless link.</span>
</p>
  
<p style="margin-left: 0.5in;"><a name="Leasing"></a><b><span
 style="font-size: 10pt; font-family: Arial;">Obtaining a lease for the wireless
link</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">Similarly, you can indicate 
that you need to use the radio communications link by using the <i><a
 href="lease.html">lease</a></i> command to manage &#8220;comms leases&#8221;. To establish
a comms lease on the local host, just type</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lease <i>seconds</i></span></p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">to keep the radio on for the
indicated number of seconds. This has the side effect of also keeping the
CPU awake, since it&#8217;s useless without the CPU running pppd. Thus, many people
have used this facility to keep the CPU awake, rather than &#8216;cpuAwake&#8217;. But
note that <b>lease</b> uses RMI, and can take several seconds to run, during
which time the CPU could decide to go to sleep. CpuAwake is really better
for keeping the CPU awake.</span> </p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">If you&#8217;re not on the node,
but are logged on elsewhere (e.g. the portal), and want a comms lease on
the node, then just add the node name to the lease command. For example,
if the node&#8217;s name is "mooring" and you want a 10 minute lease, use the command</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lease 600 mooring</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">When getting a lease, the <b>lease
</b>command returns a "lease ID" (an integer). To give up the lease and allow
the comms link to turn off (assuming no one else has a lease), type</span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">lease &#8211;terminate <i>leaseID</i></span>
</p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">You can view all cpu and comms
leases currently established on a node with the getLeases command; e.g. the
following lists all leases on localhost:<o:p></o:p></span></p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;">getLeases localhost<o:p></o:p></span></p>
  
<p style="margin-left: 0.5in;"><span
 style="font-size: 10pt; font-family: Arial;">For the full syntax of the
lease command, see the <a href="lease.html">HTML doc for lease</a>.</span>
<br>
 &nbsp;</p>
  
<p class="MsoNormal"><a name="FrequentlyUsedCommands"></a><b><span
 style="font-size: 13.5pt; font-family: Arial;">Frequently used <st1:country-region
 w:st="on">SIAM</st1:country-region> commands summary</span></b> <br>
 <span style="font-size: 10pt; font-family: Arial;">Following are frequently
used <st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
commands, and in some cases brief examples of their usage.<br>
 <b><span style="color: red;">NOTE:</span></b><span style="color: red;">
<st1:country-region w:st="on"><st1:place w:st="on">SIAM</st1:place></st1:country-region>
utilities that take a <i>hostname</i> argument can be executed remotely (e.g
via ethernet or RF), or locally on the MMC node itself.<br>
 When executed locally on the MMC host, the <i>hostname</i> argument should
be specified as "localhost" or &#8220;loc&#8221;.</span></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="annotatePort.html">annotatePort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> &#8211; annotate specified instrument
data stream</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
annotatePort mooring1 3 "Removed barnacles from shutter"</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="auxTelem.html">auxTelem.sh</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - Shell script passed to /etc/inittab
to enable</span> </p>
  
<p><span style="font-family: &quot;Courier New&quot;;"><a href="cachePort.html">cachePort.html</a></span> 
<span style="font-size: 10pt;">&#8211; </span><span
 style="font-size: 10pt; font-family: Arial;">Cache current properties of
service running on specified port(s)</span><span
 style="font-family: Arial;"><o:p></o:p></span></p>
  
<p><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span style="font-family: &quot;Courier New&quot;;">cachePort node5 2 4 5<o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="catJar.html">catJar</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - list the contents of a jar
file</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
catJar /dev/ttySX2</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="catPuck.html">catPuck</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - quickly identify the cotents
of a puck</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
catPuck /dev/ttySX7</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="conPort.html">conPort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - acquire a console to a specific
port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
conPort mooring2 10</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="cpuAwake.html">cpuAwake</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - Keep the CPU awake (veto
sleep mode), or schedule future wakeup</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
cpuAwake mooring1 600</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="dpaView.html">dpaView</a></span><span
 style="font-size: 10pt; font-family: Arial;"> &#8211; Manipulate DPA ports</span>
</p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="exitNode.html">exitNode</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - shutdown each instrument
service and exit the <st1:place w:st="on"><st1:country-region w:st="on">SIAM</st1:country-region></st1:place> 
application</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
exitNode localhost</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="getLastSample.html">getLastSample</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - retrieve and display latest
data sample from specified instrument</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
getLastSample mooring3 8</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="getLeases.html">getLeases.html</a> </span><span
 style="font-size: 10pt; font-family: Arial;">&#8211; list cpu and comms leases
established on the node</span><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><span
 style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>getLeases localhost<o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="getMetadata.html">getMetadata</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - retrieve and display metadata
from specified instrument</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
getMetadata localhost 12</span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="killj9.html">killj9</a> </span><span
 style="font-size: 10pt; font-family: Arial;">- kill j9 JVM parent process
and children</span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp; &nbsp; 
&nbsp;killj9 (no arguments)</span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="lease.html">lease</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - get a lease on the node's 
communications link</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
lease 3600</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="listPorts.html">listPorts</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - list ports and services
associated with a specified node</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
listPorts mooring5 -stats</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="listSwitches.html">listSwitches</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - list DPA power switches
associated with a specified node</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
listSwitches localhost</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="logView.html">logView</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - Display packets from specified
ISI-ID logfile residing in a specified directory</span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
logView &#8211;utc 1295 siam/logs</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="node.html">node</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - start a MOOS node service</span>
</p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
node shore</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="nodeStatus.html">nodeStatus</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - list diagnostic information
for specified MOOS node</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
nodeStatus localhost</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="portal.html">portal</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - launch a portal server</span>
</p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
portal -publish</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="portProperties.html">portProperties</a> </span><span
 style="font-size: 10pt; font-family: Arial;">&#8211; list properties for instrument
service on specified port</span><span
 style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><span
 style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>portProperties localhost<o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="portStatus.html">portStatus</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - display diagnostic information
for specified port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
portStatus mooring8 0</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="powerDownPort.html">powerDownPort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - power down and isolate an
instrument port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
powerDownPort localhost 4</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="powerUpPort.html">powerUpPort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - power up and enable comms
on an instrument port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
powerUpPort localhost 4</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="readPuck.html">readPuck</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - extract the contents of
the puck and store it in a local file</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
readPuck /dev/ttySX5</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="ricohRTC.html">ricohRTC</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - get/set time maintained
by the Ricoh RTC; or interactively set its registers</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="samplePort.html">samplePort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - trigger acquisition and
display data sample from specified instrument</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
samplePort mooring2 7</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="scanPort.html">scanPort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - load instrument service
for specified port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
scanPort mooring8 3</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="scheduler.html">schedulerUtils</a></span><span
 style="font-size: 10pt; font-family: Arial;"> &#8211; add, remove, modify sampling
schedules</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="setProperty.html">setProperty</a> </span><span
 style="font-size: 10pt; font-family: Arial;">&#8211; set instrument service property
values</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><span
 style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>setProperty node3 7 powerPolicy=ALWAYS 
commPowerPolicy=NEVER<o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><span
 style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>restartPort node3 7<o:p></o:p></span></p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="shutdownPort.html">shutdownPort</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - shutdown the service on
specified port</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
shutdownPort mooring8 3</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="suspend.html">suspend</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - put the CPU into suspend
(sleep) mode</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="switchHiVoltage.html">switchHiVoltage</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - enable the high voltage
converters on the MOOS Power System</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
switchHiVoltage mooring1 4 ON</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><a
 href="writePuck.html">writePuck</a></span><span
 style="font-size: 10pt; font-family: Arial;"> - write service code and metadata
to the puck's non-volatile memory</span> </p>
  
<p><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">&nbsp;&nbsp;&nbsp; 
writePuck jars/Seabird-2843.jar /dev/ttySX3</span> <br>
 &nbsp; <br>
 &nbsp; </p>
  
<p class="MsoNormal" style="margin-bottom: 12pt;"><br>
 <br>
 <br style="">
 <!--[if !supportLineBreakNewLine]--><br style="">
 <!--[endif]--></p>
  </div>
  <br>
</body>
</html>
